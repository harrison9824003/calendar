<div class="class_search fadeIn">
<form class="form-inline" action="index.php" method="get" enctype="multipart/form-data" name="frmInfo">
<input type='hidden' name='act' id='act' value='signup'>

<div class="form-group form-group-icon-left col-md-6">
<i class="fa fa-search input-icon input-icon-tada"></i>
 <label class="sr-only" for="search">關鍵字</label>
 <input class="form-control" placeholder="輸入關鍵字" type="text" id="search" name="search"><input class="btn btn-primary" type="submit" value="查詢">
</div>
<div class="col-md-5 class_txt">
<div class="class_type4">夜間課程</div>
<div class="class_type3">下午課程</div>
<div class="class_type2">上午課程</div>
<div class="class_type1">全天課程</div>
</div>


</form>
</div><!--end class_search-->

<div class="week_area">
<div class="week_menu">
<a class="week_prev" onclick="prevMonth();" onkeypress="prevMonth();"><i class="fa fa-angle-left box-icon-black box-icon-to-inverse box-icon-left animate-icon-border-fadeout"></i></a>
<a class="week_next" onclick="nextMonth();" onkeypress="nextMonth();"><i class="fa fa-angle-right box-icon-black box-icon-to-inverse box-icon-left animate-icon-border-fadeout"></i></a>
</div><!--end week_menu-->
<div class="week_title" id="currDateBar" ><font style=""><!-- 年份月份 --></font></div>

  <div id="dateList"></div>
  <!-- <tr>
    <th class="week_sun">日</th>
    <th>一</th>
    <th>二</th>
    <th>三</th>
    <th>四</th>
    <th>五</th>
    <th class="week_sat">六</th>
  </tr>
  <tr>
    <td valign="top" class="week_sun"><div class="date">1日</div></td>
    <td valign="top"><div class="date">2日</div><div class="class tclass_type2"><a href="#">我要成為創客...</a></div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">3日</div></td>
    <td valign="top"><div class="date">4日</div></td>
    <td valign="top"><div class="date">5日</div></td>
    <td valign="top"><div class="date">6日</div></td>
    <td valign="top" class="week_sat"><div class="date">7日</div></td>
  </tr>
  <tr>
    <td valign="top" class="week_sun"><div class="date">8日</div></td>
    <td valign="top"><div class="date">9日</div></td>
    <td valign="top"><div class="date">10日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">11日</div></td>
    <td valign="top" class="on"><div class="date">12日</div></td>
    <td valign="top"><div class="date">13日</div></td>
    <td valign="top" class="week_sat"><div class="date">14日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
  </tr>
  <tr>
    <td valign="top" class="week_sun"><div class="date">15日</div></td>
    <td valign="top"><div class="date">16日</div></td>
    <td valign="top"><div class="date">17日</div></td>
    <td valign="top"><div class="date">18日</div></td>
    <td valign="top"><div class="date">19日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">20日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top" class="week_sat"><div class="date">21日</div></td>
  </tr>
  <tr>
    <td valign="top" class="week_sun"><div class="date">22日</div></td>
    <td valign="top"><div class="date">23日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">24日</div><div class="class tclass_type2"><a href="#">我要成為創客...</a></div></td>
    <td valign="top"><div class="date">25日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">26日</div><div class="class tclass_type2"><a href="#">我要成為創客...</a></div></td>
    <td valign="top"><div class="date">27日</div><div class="class tclass_type2"><a href="#">我要成為創客...</a></div></td>
    <td valign="top" class="week_sat"><div class="date">28日</div><div class="class tclass_type2"><a href="#">我要成為創客...</a></div></td>
  </tr>
  <tr>
    <td valign="top" class="week_sun"><div class="date">29日</div><div class="class tclass_type1"><a href="#">南方創客基地...</a></div></td>
    <td valign="top"><div class="date">30日</div></td>
    <td valign="top"><div class="date">31日</div></td>
    <td valign="top"> </td>
    <td valign="top"> </td>
    <td valign="top"> </td>
    <td valign="top" class="week_sat"> </td>
  </tr> -->

</div>

<div class="class_remark col-md-12">
<p>課程報名：</p>
<p>● 報名途徑：請登入會員→課程訊息→點選進入欲報名的課程→點選「我要報名」。 </p>
<p>● 若欲取消，請來電告知創客基地，以利其他會員使用。 </p>
</div>
<script>
var calendarMonth;  // 月曆當前月份
var calendarYear;   // 月曆當前年份
var xhr;    // ajax handler
var timer;  // timer handler
var tdCurrMonthStart;   // 月曆當前月份TD起始index
var tdCurrMonthEnd; // 月曆當前月份TD結束"隔天"index
var begin;
var currIndex;
var week_text = ['日','一','二','三','四','五','六'];
var week = '';
for(i=0; i<7;){
    week += '<th'+((i==0 || i==6) ? (i==0 ? ' class="week_sun"' : ' class="week_sat"') : '')+'>星期'+week_text[i++]+'</td>'
}
week = '<tr>'+week+'</tr>';

$(function() {
    
    var weekBar = '';

    makeCalendar();
});

function makeCalendar(tarDate) {
    if(typeof tarDate=='undefined'){
        var currDate = new Date();
    }
    else{
        var currDate = tarDate;
    }
    var currDate = new Date(new Date(currDate.setDate(1)).setHours(0,0,0,0));   // 目前月份1日 00:00:00(object)
    var firstDay = currDate.getDay();   // 目前月份1日星期
    var currMonth = currDate.getMonth();    // 目前月份
    // 月曆起始日期(上個月最後一周)
    if(firstDay==0)
        begin = new Date(currDate.getTime()-86400*7*1000);
    else
        begin = new Date(currDate.getTime()-86400*firstDay*1000);
    currIndex = begin;  // 當前日期指標

    calendarMonth = currMonth;  // 月曆當前月份
    calendarYear = currDate.getFullYear();  // 月曆當前年份

    var dates = '';
    var tdIndex = 0;
    tdCurrMonthStart = 0;
    tdCurrMonthEnd = 0;
    for(i=0; i<6; i++){
        tr = '';
        for(j=0; j<7; j++){
            if(currIndex.getMonth()!=currMonth){
                if(i>0){
                    tdCurrMonthEnd = tdCurrMonthEnd || tdIndex;
                }
                tr += '<td valign="top" '+((j==0 || j==6) ? (j==0 ? ' class="week_sun"' : ' class="week_sat"') : '')+' ><div class="date">'+currIndex.getDate()+'日</div><div id="dateTd_'+(tdIndex++)+'"></div></td>';
            }
            else{
                tdCurrMonthStart = tdCurrMonthStart || tdIndex;
                tr += '<td valign="top" '+((j==0 || j==6) ? (j==0 ? ' class="week_sun"' : ' class="week_sat"') : '')+' ><div class="date">'+currIndex.getDate()+'日</div><div id="dateTd_'+(tdIndex++)+'"></div></td>';
            }
            currIndex = new Date(currIndex.getTime()+86400*1000);
        }
        dates += '<tr>'+tr+'</tr>';
    }
    $("#dateList").html('<table width="100%" border="0" cellspacing="0" cellpadding="0" class="week"><caption>課程行事曆</caption>'+week+dates+'</table>');
    $("#currDateBar font").html(calendarYear+'年'+((calendarMonth+1)<10 ? '0'+(calendarMonth+1) : (calendarMonth+1))+'月');

    clearTimeout(timer);
    timer = setTimeout("ajax_count()", 100);
}
var prev;
var next;

function nextMonth() {
    if(calendarMonth==11){
        next = 1;
        calendarYear++;
    }
    else{
        next = calendarMonth+2;
    }
    makeCalendar(new Date(new Date().setFullYear(calendarYear, next, 0)));
}

function prevMonth() {
    if(calendarMonth==0){
        prev = 12;
        calendarYear--;
    }
    else{
        prev = calendarMonth;
    }
    makeCalendar(new Date(new Date().setFullYear(calendarYear, prev, 0)));
}

function ajax_count() {
    if(xhr && xhr.readystate != 4){
        xhr.abort();
    }
    xhr = $.ajax({
        url: 'index.php?act=signup&code=count',
        data: {'start':myDateFormat(begin), 'end':myDateFormat(new Date(currIndex.getTime()-86400*1000))},
        type: 'POST',
        success: function (data) {
            count = data.split(',');
            for(i=0, cnt=count.length; i<cnt; i++){
                $("#dateTd_"+i).html(count[i]);
            }
        },
        error: function (msg) {
        }
    })
}

function myDateFormat(dateTime) {
    try{
        if(typeof(dateTime)=='object'){
            objDate = new Date(dateTime.valueOf());
        }
        else if(typeof(dateTime)=='number'){
            objDate = new Date(dateTime);
        }
        return objDate.getFullYear() + "-" + (objDate.getMonth()+1) + "-" + objDate.getDate();
    }catch(e){
        alert(e.message);
    }
}
</script>